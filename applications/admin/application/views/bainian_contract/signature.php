<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Signature Pad demo</title>
  <meta name="description" content="Signature Pad - HTML5 canvas based smooth signature drawing using variable width spline interpolation.">

  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <link rel="stylesheet" href="<?php echo css_js_url('signature-pad.css', 'admin');?>">

</head>
<body onselectstart="return false">

<div class="cont50">开单日期：<a id="show_signature" style="text-decoration: underline;">点击生成你的签名</a> </div>
<table width="860" border="0" cellspacing="0" cellpadding="0" class="martop">
            <tr>
                <td colspan="5"><strong>其他事项</strong></td>
            </tr>
            <tr>
                <td width="189">婚庆公司</td>
                <td width="140"></td>
                <td width="189">麻将</td>
                <td width="140"></td>
                <td width="189">麻将10:2分配</td>
            </tr>
            <tr>
                <td colspan="3" class="text-left">通过哪个媒体选择到“百年婚宴”订餐</td>
                <td colspan="2" class="text-left"></td>
            </tr>
            <tr>
                <td colspan="5" class="text-left">婚车线路：  </td>
            </tr>
            <tr>
                <td colspan="5" class="text-left">婚车时间：  </td>
            </tr>
            <tr>
                <td rowspan="7" >订单处理情况</td>
                <td colspan="4" class="text-left">1、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">2、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">3、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">4、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">5、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">6、安顺市区客户：         厂区客户：        其他客户：</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">7、19：00前需要上菜的客户，乙方须提前1天电话/短信通知甲方。</td>
            </tr>
            <tr>
                <td>当日未能结账客户<br>需要提交的资料</td>
                <td colspan="4">
                    <p class="table-cont text-left">1.定餐客户身份证复印件：</p>
                    <p class="table-cont text-left">2.定餐客户单位：</p>
                    <p class="table-cont text-left">3.定餐客户公司名称： </p>
                    <p class="table-cont text-left">4.定餐客户现住地址：</p>
                    <p class="table-cont text-left">5.客户新房地址：</p>
                </td>
            </tr>
            <tr>
                <td>客户须知</td>
                <td colspan="4">
                    <p class="table-cont text-left">1.带壳瓜子、花生、坚果类不允许带进酒店（糖果类不限制）。</p>
                    <p class="table-cont text-left">2.纸质喷花、瓶装啤酒、氢气球不允许带进酒店。</p>
                    <p class="table-cont text-left">3.定制个性请柬需提前2个月发照片到公司QQ邮箱；675932888。 </p>
                </td>
            </tr>
        </table>
        <table width="860" border="0" cellspacing="0" cellpadding="0" class="martop">
            <tr>
                <td colspan="5"><strong>其他事项</strong></td>
            </tr>
            <tr>
                <td width="189">婚庆公司</td>
                <td width="140"></td>
                <td width="189">麻将</td>
                <td width="140"></td>
                <td width="189">麻将10:2分配</td>
            </tr>
            <tr>
                <td colspan="3" class="text-left">通过哪个媒体选择到“百年婚宴”订餐</td>
                <td colspan="2" class="text-left"></td>
            </tr>
            <tr>
                <td colspan="5" class="text-left">婚车线路：  </td>
            </tr>
            <tr>
                <td colspan="5" class="text-left">婚车时间：  </td>
            </tr>
            <tr>
                <td rowspan="7" >订单处理情况</td>
                <td colspan="4" class="text-left">1、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">2、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">3、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">4、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">5、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">6、安顺市区客户：         厂区客户：        其他客户：</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">7、19：00前需要上菜的客户，乙方须提前1天电话/短信通知甲方。</td>
            </tr>
            <tr>
                <td>当日未能结账客户<br>需要提交的资料</td>
                <td colspan="4">
                    <p class="table-cont text-left">1.定餐客户身份证复印件：</p>
                    <p class="table-cont text-left">2.定餐客户单位：</p>
                    <p class="table-cont text-left">3.定餐客户公司名称： </p>
                    <p class="table-cont text-left">4.定餐客户现住地址：</p>
                    <p class="table-cont text-left">5.客户新房地址：</p>
                </td>
            </tr>
            <tr>
                <td>客户须知</td>
                <td colspan="4">
                    <p class="table-cont text-left">1.带壳瓜子、花生、坚果类不允许带进酒店（糖果类不限制）。</p>
                    <p class="table-cont text-left">2.纸质喷花、瓶装啤酒、氢气球不允许带进酒店。</p>
                    <p class="table-cont text-left">3.定制个性请柬需提前2个月发照片到公司QQ邮箱；675932888。 </p>
                </td>
            </tr>
        </table>
        <table width="860" border="0" cellspacing="0" cellpadding="0" class="martop">
            <tr>
                <td colspan="5"><strong>其他事项</strong></td>
            </tr>
            <tr>
                <td width="189">婚庆公司</td>
                <td width="140"></td>
                <td width="189">麻将</td>
                <td width="140"></td>
                <td width="189">麻将10:2分配</td>
            </tr>
            <tr>
                <td colspan="3" class="text-left">通过哪个媒体选择到“百年婚宴”订餐</td>
                <td colspan="2" class="text-left"></td>
            </tr>
            <tr>
                <td colspan="5" class="text-left">婚车线路：  </td>
            </tr>
            <tr>
                <td colspan="5" class="text-left">婚车时间：  </td>
            </tr>
            <tr>
                <td rowspan="7" >订单处理情况</td>
                <td colspan="4" class="text-left">1、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">2、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">3、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">4、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">5、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">6、安顺市区客户：         厂区客户：        其他客户：</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">7、19：00前需要上菜的客户，乙方须提前1天电话/短信通知甲方。</td>
            </tr>
            <tr>
                <td>当日未能结账客户<br>需要提交的资料</td>
                <td colspan="4">
                    <p class="table-cont text-left">1.定餐客户身份证复印件：</p>
                    <p class="table-cont text-left">2.定餐客户单位：</p>
                    <p class="table-cont text-left">3.定餐客户公司名称： </p>
                    <p class="table-cont text-left">4.定餐客户现住地址：</p>
                    <p class="table-cont text-left">5.客户新房地址：</p>
                </td>
            </tr>
            <tr>
                <td>客户须知</td>
                <td colspan="4">
                    <p class="table-cont text-left">1.带壳瓜子、花生、坚果类不允许带进酒店（糖果类不限制）。</p>
                    <p class="table-cont text-left">2.纸质喷花、瓶装啤酒、氢气球不允许带进酒店。</p>
                    <p class="table-cont text-left">3.定制个性请柬需提前2个月发照片到公司QQ邮箱；675932888。 </p>
                </td>
            </tr>
        </table>
        <table width="860" border="0" cellspacing="0" cellpadding="0" class="martop">
            <tr>
                <td colspan="5"><strong>其他事项</strong></td>
            </tr>
            <tr>
                <td width="189">婚庆公司</td>
                <td width="140"></td>
                <td width="189">麻将</td>
                <td width="140"></td>
                <td width="189">麻将10:2分配</td>
            </tr>
            <tr>
                <td colspan="3" class="text-left">通过哪个媒体选择到“百年婚宴”订餐</td>
                <td colspan="2" class="text-left"></td>
            </tr>
            <tr>
                <td colspan="5" class="text-left">婚车线路：  </td>
            </tr>
            <tr>
                <td colspan="5" class="text-left">婚车时间：  </td>
            </tr>
            <tr>
                <td rowspan="7" >订单处理情况</td>
                <td colspan="4" class="text-left">1、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">2、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">3、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">4、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">5、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">6、安顺市区客户：         厂区客户：        其他客户：</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">7、19：00前需要上菜的客户，乙方须提前1天电话/短信通知甲方。</td>
            </tr>
            <tr>
                <td>当日未能结账客户<br>需要提交的资料</td>
                <td colspan="4">
                    <p class="table-cont text-left">1.定餐客户身份证复印件：</p>
                    <p class="table-cont text-left">2.定餐客户单位：</p>
                    <p class="table-cont text-left">3.定餐客户公司名称： </p>
                    <p class="table-cont text-left">4.定餐客户现住地址：</p>
                    <p class="table-cont text-left">5.客户新房地址：</p>
                </td>
            </tr>
            <tr>
                <td>客户须知</td>
                <td colspan="4">
                    <p class="table-cont text-left">1.带壳瓜子、花生、坚果类不允许带进酒店（糖果类不限制）。</p>
                    <p class="table-cont text-left">2.纸质喷花、瓶装啤酒、氢气球不允许带进酒店。</p>
                    <p class="table-cont text-left">3.定制个性请柬需提前2个月发照片到公司QQ邮箱；675932888。 </p>
                </td>
            </tr>
        </table>
        <table width="860" border="0" cellspacing="0" cellpadding="0" class="martop">
            <tr>
                <td colspan="5"><strong>其他事项</strong></td>
            </tr>
            <tr>
                <td width="189">婚庆公司</td>
                <td width="140"></td>
                <td width="189">麻将</td>
                <td width="140"></td>
                <td width="189">麻将10:2分配</td>
            </tr>
            <tr>
                <td colspan="3" class="text-left">通过哪个媒体选择到“百年婚宴”订餐</td>
                <td colspan="2" class="text-left"></td>
            </tr>
            <tr>
                <td colspan="5" class="text-left">婚车线路：  </td>
            </tr>
            <tr>
                <td colspan="5" class="text-left">婚车时间：  </td>
            </tr>
            <tr>
                <td rowspan="7" >订单处理情况</td>
                <td colspan="4" class="text-left">1、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">2、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">3、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">4、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">5、</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">6、安顺市区客户：         厂区客户：        其他客户：</td>
            </tr>
            <tr>
                <td colspan="4" class="text-left">7、19：00前需要上菜的客户，乙方须提前1天电话/短信通知甲方。</td>
            </tr>
            <tr>
                <td>当日未能结账客户<br>需要提交的资料</td>
                <td colspan="4">
                    <p class="table-cont text-left">1.定餐客户身份证复印件：</p>
                    <p class="table-cont text-left">2.定餐客户单位：</p>
                    <p class="table-cont text-left">3.定餐客户公司名称： </p>
                    <p class="table-cont text-left">4.定餐客户现住地址：</p>
                    <p class="table-cont text-left">5.客户新房地址：</p>
                </td>
            </tr>
            <tr>
                <td>客户须知</td>
                <td colspan="4">
                    <p class="table-cont text-left">1.带壳瓜子、花生、坚果类不允许带进酒店（糖果类不限制）。</p>
                    <p class="table-cont text-left">2.纸质喷花、瓶装啤酒、氢气球不允许带进酒店。</p>
                    <p class="table-cont text-left">3.定制个性请柬需提前2个月发照片到公司QQ邮箱；675932888。 </p>
                </td>
            </tr>
        </table>

  <div  id="signature-pad" class="m-signature-pad">
    <div class="m-signature-pad--body">
      <canvas></canvas>
    </div>
    <div class="m-signature-pad--footer">
      <div class="description">Sign above</div>
      <button type="button" class="button clear" data-action="clear">Clear</button>
      <button type="button" class="button save" data-action="save">Save</button>
    </div>
  </div>
  
  <?php $this->load->view('common/footer') ?>
    <script>
        seajs.use([
            '<?php echo css_js_url('signature_pad.js', 'admin');?>',
        ], function(a){
            $(function(){
                var wrapper = document.getElementById("signature-pad"),
                clearButton = wrapper.querySelector("[data-action=clear]"),
                saveButton = wrapper.querySelector("[data-action=save]"),
                canvas = wrapper.querySelector("canvas"),
                signaturePad;
            
                // Adjust canvas coordinate space taking into account pixel ratio,
                // to make it look crisp on mobile devices.
                // This also causes canvas to be cleared.
                function resizeCanvas() {
                    // When zoomed out to less than 100%, for some very strange reason,
                    // some browsers report devicePixelRatio as less than 1
                    // and only part of the canvas is cleared then.
                    var ratio =  Math.max(window.devicePixelRatio || 1, 1);
                    canvas.width = canvas.offsetWidth * ratio;
                    canvas.height = canvas.offsetHeight * ratio;
                    canvas.getContext("2d").scale(ratio, ratio);
                }
                
                window.onresize = resizeCanvas;
                resizeCanvas();
                
                signaturePad = new SignaturePad(canvas);
                
                clearButton.addEventListener("click", function (event) {
                    signaturePad.clear();
                });
                
                saveButton.addEventListener("click", function (event) {
                    if (signaturePad.isEmpty()) {
                        alert("Please provide signature first.");
                    } else {
                      

                      var fd = new FormData();
                      var blob = dataURItoBlob(signaturePad.toDataURL());
                      
                      fd.append('Filedata', blob);
                      fd.append('type', 'image');
                      fd.append('file_name', 'image.png');
                      
                      
                      console.log(fd);
                      
                      
                      $.ajax({
    						url:'http://upload.dev.bai-nian.com/file/upload',
    						type:'POST',
    						data:fd,
    						cache: false,
    						contentType: false,    
    						processData: false,
    						dataType:'json',
    						beforeSend:function(){
    						},
    						success:function(res){
    							if (res.error === 0) {
    							  $('#signature-pad').toggle();
    							  $('#show_signature').empty();
    							  $('#show_signature').append('<img src="'+ res.full_url +'">');
    							  
    							}
    						}
    					});
                        
                    }
                });

                $('#show_signature').on('click', function(){
                  $('#signature-pad').toggle();
                });

                $("#uploadbtn").click(function(){
      				
      				$('#uploadImg').unbind().on('change',function(e){
      					_self = $(_self);
      					data = new FormData();
      					$.each($('#uploadImg')[0].files, function(i, file) {
      						data.append('Filedata', file);
      					});
                        	data.append('type', 'image');
      					$.ajax({
      						url:uploadUrl+'/file/upload',
      						type:'POST',
      						data:data,
      						cache: false,
      						contentType: false,    
      						processData: false,
      						dataType:'json',
      						beforeSend:function(){
      						},
      						success:function(data){
      								$('#uploadbtn').children('input').val(data.url);
      								$('#uploadbtn').children('img').attr('src', data.full_url);
      								e.stopPropagation();
      						}
      					});
      				})
      			})

      			function dataURItoBlob(dataURI) {
                    var byteString = atob(dataURI.split(',')[1]);
                    var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];
                    var ab = new ArrayBuffer(byteString.length);
                    var ia = new Uint8Array(ab);
                    for (var i = 0; i < byteString.length; i++) {
                        ia[i] = byteString.charCodeAt(i);
                    }
                    return new Blob([ab], {type: mimeString});
                }

      			
            });
        })
    </script>


  

</body>
</html>
